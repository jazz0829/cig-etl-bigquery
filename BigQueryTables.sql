CREATE TABLE config.BigQuery_DataExportLog
(
	DataSetId VARCHAR(50) NOT NULL,
	TableName VARCHAR(50) NOT NULL,
	ExportDate DATE NOT NULL,
	InsertTime DATETIME NOT NULL
)

CREATE TABLE [raw].BigQuery_Salesforce
(
	visitorId INT NULL,
	visitNumber INT NULL,
	visitId	INT NULL,
	visitStartTime INT NULL,
	[date] CHAR(8),
	totals_visits INT NULL,
	totals_hits	INT NULL,
	totals_pageviews INT NULL,
	totals_timeOnSite INT NULL,
	totals_bounces INT NULL,
	totals_transactions INT NULL,
	totals_transactionRevenue INT NULL,
	totals_newVisits INT NULL,
	totals_screenViews INT NULL,
	totals_uniqueScreenViews INT NULL,
	totals_timeOnScreen INT NULL,
	totals_totalTransactionRevenue INT NULL,
	--totals_sessionQualityDim INT NULL,
	trafficSource_referralPath VARCHAR(1000) NULL,
	trafficSource_campaign VARCHAR(500) NULL,
	trafficSource_source VARCHAR(1000) NULL,
	trafficSource_medium VARCHAR(500) NULL,
	trafficSource_keyword VARCHAR(500) NULL,
	trafficSource_adContent	VARCHAR(1000) NULL,
	trafficSource_adwordsClickInfo_campaignId INT NULL,
	trafficSource_adwordsClickInfo_adGroupId INT NULL,
	trafficSource_adwordsClickInfo_creativeId INT NULL,
	trafficSource_adwordsClickInfo_criteriaId INT NULL,
	trafficSource_adwordsClickInfo_page INT NULL,
	trafficSource_adwordsClickInfo_slot	VARCHAR(100) NULL,
	trafficSource_adwordsClickInfo_criteriaParameters VARCHAR(500) NULL,
	trafficSource_adwordsClickInfo_gclId VARCHAR(100) NULL,
	trafficSource_adwordsClickInfo_customerId INT NULL,
	trafficSource_adwordsClickInfo_adNetworkType VARCHAR(100) NULL,
	trafficSource_adwordsClickInfo_targetCriteria_boomUserlistId INT NULL,
	trafficSource_adwordsClickInfo_isVideAd BIT NULL,
	trafficSource_isTrueDirect BIT NULL,
	trafficSource_campaignCode VARCHAR(100) NULL,
	device_browser VARCHAR(100) NULL,
	device_browserVersion VARCHAR(50) NULL,
	device_browserSize VARCHAR(50) NULL,
	device_operatingSystem VARCHAR(50) NULL,
	device_operatingSystemVersion VARCHAR(50) NULL,
	device_isMobile BIT NULL,
	device_mobileDeviceBranding VARCHAR(50) NULL,
	device_mobileDeviceModel VARCHAR(50) NULL,
	device_mobileInputSelector VARCHAR(50) NULL,
	device_mobileDeviceInfo VARCHAR(50) NULL,
	device_mobileDeviceMarketingName VARCHAR(50) NULL,
	device_flashVersion	VARCHAR(10) NULL,
	device_javaEnabled BIT NULL,
	device_language	VARCHAR(50) NULL,
	device_screenColors	VARCHAR(10) NULL,
	device_screenResolution	VARCHAR(20) NULL,
	device_deviceCategory VARCHAR(50) NULL,
	geoNetwork_continent VARCHAR(50) NULL,
	geoNetwork_subContinent	VARCHAR(50) NULL,
	geoNetwork_country VARCHAR(50) NULL,
	geoNetwork_region VARCHAR(100) NULL,
	geoNetwork_metro VARCHAR(100) NULL,
	geoNetwork_city	VARCHAR(500) NULL,
	geoNetwork_cityId VARCHAR(50) NULL,
	geoNetwork_networkDomain VARCHAR(100) NULL,
	geoNetwork_latitude	VARCHAR(20) NULL,
	geoNetwork_longitude VARCHAR(20) NULL,
	geoNetwork_networkLocation VARCHAR(500) NULL,
	CustomDimensions_index INT NULL,
	CustomDimensions_value VARCHAR(1000) NULL,
	hits_hitNumber INT NULL,
	hits_time INT NULL,
	hits_hour INT NULL,
	hits_minute INT NULL,
	hits_isSecure BIT NULL,
	hits_isInteraction BIT NULL,
	hits_isEntrance BIT NULL,
	hits_isExit BIT NULL,
	hits_referer VARCHAR(2000) NULL,
	hits_page_pagePath VARCHAR(1000) NULL,
	hits_page_hostname VARCHAR(200) NULL,
	hits_page_pageTitle VARCHAR(500) NULL,
	hits_page_searchKeyword VARCHAR(200) NULL,
	hits_page_searchCategory VARCHAR(200) NULL,
	hits_page_pagePathLevel1 VARCHAR(200) NULL,
	hits_page_pagePathLevel2 VARCHAR(200) NULL,
	hits_page_pagePathLevel3 VARCHAR(200) NULL,
	hits_page_pagePathLevel4 VARCHAR(500) NULL,
	hits_transaction_transactionId VARCHAR(50) NULL,
	hits_transaction_transactionRevenue	INT NULL,
	hits_transaction_transactionTax INT NULL,
	hits_transaction_transactionShipping INT NULL,
	hits_transaction_affiliation VARCHAR(200) NULL,
	hits_transaction_currencyCode VARCHAR(20) NULL,
	hits_transaction_localTransactionRevenue INT NULL,
	hits_transaction_localTransactionTax INT NULL,
	hits_transaction_localTransactionShipping INT NULL,
	hits_transaction_transactionCoupon VARCHAR(50) NULL,
	hits_item_transactionId VARCHAR(50) NULL,
	hits_item_productName VARCHAR(500) NULL,
	hits_item_productCategory VARCHAR(500) NULL,
	hits_item_productSku VARCHAR(200) NULL,
	hits_item_itemQuantity INT NULL,
	hits_item_itemRevenue INT NULL,
	hits_item_currencyCode VARCHAR(20) NULL,
	hits_item_localItemRevenue INT NULL,
	hits_contentInfo_contentDescription	VARCHAR(500) NULL,
	hits_appInfo_name VARCHAR(200) NULL,
	hits_appInfo_version VARCHAR(50) NULL,
	hits_appInfo_id	VARCHAR(50) NULL,
	hits_appInfo_installerId VARCHAR(50) NULL,
	hits_appInfo_appInstallerId	VARCHAR(50) NULL,
	hits_appInfo_appName VARCHAR(200) NULL,
	hits_appInfo_appVersion	VARCHAR(50) NULL,
	hits_appInfo_appId VARCHAR(50) NULL,
	hits_appInfo_screenName	VARCHAR(500) NULL,
	hits_appInfo_landingScreenName VARCHAR(500) NULL,
	hits_appInfo_exitScreenName	VARCHAR(500) NULL,
	hits_appInfo_sceenDepth	VARCHAR(100) NULL,
	hits_exceptionInfo_description VARCHAR(1000) NULL,
	hits_exceptionInfo_isFatal BIT NULL,
	hits_exceptionInfo_exceptions INT NULL,
	hits_exceptionInfo_fatalExceptions INT NULL,
	hits_eventInfo_eventCategory VARCHAR(500) NULL,
	hits_eventInfo_eventAction VARCHAR(500) NULL,
	hits_eventInfo_eventLabel VARCHAR(8000) NULL,
	hits_eventInfo_eventValue INT NULL,
	hits_product_productSKU	VARCHAR(100) NULL,
	hits_product_v2ProductName VARCHAR(500) NULL,
	hits_product_v2ProductCategory VARCHAR(200) NULL,
	hits_product_productVariant VARCHAR(200) NULL,
	hits_product_productBrand VARCHAR(200) NULL,
	hits_product_productRevenue INT NULL,
	hits_product_localProductRevenue INT NULL,
	hits_product_productPrice INT NULL,
	hits_product_localProductPrice INT NULL,
	hits_product_productQuantity INT NULL,
	hits_product_productRefundAmount INT NULL,
	hits_product_localProductRefundAmount INT NULL,
	hits_product_isImpression BIT NULL,
	hits_product_isClick BIT NULL,
	hits_product_customDimensions_index	INT NULL,
	hits_product_customDimensions_value	VARCHAR(1000) NULL,
	hits_product_customMetrics_index INT NULL,
	hits_product_customMetrics_value VARCHAR(1000) NULL,
	hits_product_productListName VARCHAR(200) NULL,
	hits_product_productListPosition INT NULL,
	hits_promotion_promoId VARCHAR(100) NULL,
	hits_promotion_promoName VARCHAR(500) NULL,
	hits_promotion_promoCreative VARCHAR(500) NULL,
	hits_promotion_promoPosition VARCHAR(500) NULL,
	hits_prmotionActionInfo_promoIsView	BIT NULL,
	hits_prmotionActionInfo_promoIsClick BIT NULL,
	hits_refund_refoundAmount INT NULL,
	hits_refund_localRefundAmount INT NULL,
	hits_eCommerceAction_action_type VARCHAR(200) NULL,
	hits_eCommerceAction_step INT NULL,
	hits_eCommerceAction_option VARCHAR(200) NULL,
	hits_experiment_experimentId VARCHAR(50) NULL,
	hits_experiment_experimentVariant VARCHAR(200) NULL,
	hits_publisher_dfpClicks INT NULL,
	hits_publisher_dfpImpressions INT NULL,
	hits_publisher_dfpMatchedQueries INT NULL,
	hits_publisher_dfpMeasurableImpressions INT NULL,
	hits_publisher_dfpQueries INT NULL,
	hits_publisher_dfpRevenueCpm INT NULL,
	hits_publisher_dfpRevenueCpc INT NULL,
	hits_publisher_dfpViewableImpressions INT NULL,
	hits_publisher_dfpPagesViewed INT NULL,
	hits_publisher_adsenseBackfillDfpClicks INT NULL,
	hits_publisher_adsenseBackfillDfpImpressions INT NULL,
	hits_publisher_adsenseBackfillDfpMatchedQueries INT NULL,
	hits_publisher_adsenseBackfillDfpMeasurableImpressions INT NULL,
	hits_publisher_adsenseBackfillDfpQueries INT NULL,
	hits_publisher_adsenseBackfillDfpRevenueCpm INT NULL,
	hits_publisher_adsenseBackfillDfpRevenueCpc INT NULL,
	hits_publisher_adsenseBackfillDfpViewableImpressions INT NULL,
	hits_publisher_adsenseBackfillDfpPagesViewed INT NULL,
	hits_publisher_adxBackfillDfpClicks INT NULL,
	hits_publisher_adxBackfillDfpImpressions INT NULL,
	hits_publisher_adxBackfillDfpMatchedQueries	INT NULL,
	hits_publisher_adxBackfillDfpMeasurableImpressions INT NULL,
	hits_publisher_adxBackfillDfpQueries INT NULL,
	hits_publisher_adxBackfillDfpRevenueCpm INT NULL,
	hits_publisher_adxBackfillDfpRevenueCpc INT NULL,
	hits_publisher_adxBackfillDfpViewableImpressions INT NULL,
	hits_publisher_adxBackfillDfpPagesViewed INT NULL,
	hits_publisher_adxClicks INT NULL,
	hits_publisher_adxImpressions INT NULL,
	hits_publisher_adxMatchedQueries INT NULL,
	hits_publisher_adxMeasurableImpressions INT NULL,
	hits_publisher_adxQueries INT NULL,
	hits_publisher_adxRevenue INT NULL,
	hits_publisher_adxViewableImpressions INT NULL,
	hits_publisher_adxPagesViewed INT NULL,
	hits_publisher_adsViewed INT NULL,
	hits_publisher_adsUnitsViewed INT NULL,
	hits_publisher_adsUnitsMatched INT NULL,
	hits_publisher_viewableAdsViewed INT NULL,
	hits_publisher_measurableAdsViewed INT NULL,
	hits_publisher_adsPagesViewed INT NULL,
	hits_publisher_adsClicked INT NULL,
	hits_publisher_adsRevenue INT NULL,
	hits_publisher_dfpAdGroup VARCHAR(200) NULL,
	hits_publisher_dfpAdUnits VARCHAR(100) NULL,
	hits_publisher_dfpNetworkId VARCHAR(100) NULL,
	hits_custom_variables_index INT NULL,
	hits_custom_variables_customVarName VARCHAR(200) NULL,
	hits_custom_variables_ustomVarValue VARCHAR(1000) NULL,
	hits_customDimensions_index INT NULL,
	hits_customDimensions_value VARCHAR(1000) NULL,
	hits_customMetrics_index INT NULL,
	hits_customMetrics_value INT NULL,
	hits_type VARCHAR(20),
	hits_social_socialInteractionNetwork VARCHAR(200) NULL,
	hits_social_socialInteractionAction	VARCHAR(200) NULL,
	hits_social_socialInteractions INT NULL,
	hits_social_socialInteractionTarget VARCHAR(200) NULL,
	hits_social_socialNetwork VARCHAR(200) NULL,
	hits_social_uniqueSocialInteractions INT NULL,
	hits_social_hasSocialSourceReferral VARCHAR(200) NULL,
	hits_social_socialInteractionNetworkAction VARCHAR(200) NULL,
	hits_latencyTracking_pageLoadSample INT NULL,
	hits_latencyTracking_pageLoadTime INT NULL,
	hits_latencyTracking_pageDownloadTime INT NULL,
	hits_latencyTracking_redirectionTime INT NULL,
	hits_latencyTracking_speedMetricsSample INT NULL,
	hits_latencyTracking_domainLookupTime INT NULL,
	hits_latencyTracking_serverConnectionTime INT NULL,
	hits_latencyTracking_serverResponseTime INT NULL,
	hits_latencyTracking_domLatencyMetricsSample INT NULL,
	hits_latencyTracking_domInteractiveTime INT NULL,
	hits_latencyTracking_domContentLoadedTime INT NULL,
	hits_latencyTracking_userTimingValue INT NULL,
	hits_latencyTracking_userTimingSample INT NULL,
	hits_latencyTracking_userTimingVariable VARCHAR(100) NULL,
	hits_latencyTracking_userTimingCategory	VARCHAR(100) NULL,
	hits_latencyTracking_userTimingLabel VARCHAR(100) NULL,
	hits_sourcePropertyInfo_sourcePropertyDisplayName VARCHAR(200) NULL,
	hits_sourcePropertyInfo_sourcePropertyTrackingId VARCHAR(100) NULL,
	hits_contentGroup_contentGroup1 VARCHAR(100) NULL,
	hits_contentGroup_contentGroup2	VARCHAR(100) NULL,
	hits_contentGroup_contentGroup3	VARCHAR(100) NULL,
	hits_contentGroup_contentGroup4	VARCHAR(100) NULL,
	hits_contentGroup_contentGroup5	VARCHAR(100) NULL,
	hits_contentGroup_previousContentGroup1	VARCHAR(100) NULL,
	hits_contentGroup_previousContentGroup2	VARCHAR(100) NULL,
	hits_contentGroup_previousContentGroup3	VARCHAR(100) NULL,
	hits_contentGroup_previousContentGroup4	VARCHAR(100) NULL,
	hits_contentGroup_previousContentGroup5	VARCHAR(100) NULL,
	hits_contentGroup_contentGroupUniqueViews1 INT NULL,
	hits_contentGroup_contentGroupUniqueViews2 INT NULL,
	hits_contentGroup_contentGroupUniqueViews3 INT NULL,
	hits_contentGroup_contentGroupUniqueViews4 INT NULL,
	hits_contentGroup_contentGroupUniqueViews5 INT NULL,
	hits_dataSource	VARCHAR(100) NULL,
	fullVisitorId  VARCHAR(50) NULL,
	userId VARCHAR(50) NULL,
	channelGrouping	VARCHAR(50) NULL,
	socialEngagementType VARCHAR(200) NULL,
	EtlInsertTime DATETIME NOT NULL,
	userIdLong VARCHAR(50) NULL
)

CREATE CLUSTERED COLUMNSTORE INDEX CIX_BigQuery_Salesforce ON [raw].BigQuery_Salesforce


CREATE ROLE BigQueryImport

GRANT SELECT, INSERT ON config.BigQuery_DataExportLog TO BigQueryImport
GRANT SELECT, INSERT, UPDATE ON [raw].BigQuery_Salesforce TO BigQueryImport
GRANT SELECT, INSERT, UPDATE ON config.ETLLog TO BigQueryImport

